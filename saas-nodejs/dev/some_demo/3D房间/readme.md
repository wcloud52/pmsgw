#3D房间

###＊＊**前注**＊＊
本文内容参考学习【张鑫旭】的文章所写。

DEMO链接域名为zhagnxinyu的，则引自其个人网站。

如果对某些概念不能理解，可以查看以下链接来看示意图。

参考链接：

http://www.zhangxinxu.com/wordpress/2012/09/css3-3d-transform-perspective-animate-transition/



###＊＊**基础**＊＊
DOM结构如下：

    舞台
    |
    |———— 容器1
    |    |
    |    |———— 图片1
    |    |
    |    |———— 图片2（以及其他）
    |
    |
    |———— 容器2
    |   |
    ……  |—— 图片1
        |
        |—— 图片2（以及其他）
        

3D在Z轴上的结构如下：

    视角（用户在屏幕外距离屏幕的距离）——————屏幕（具体而言是舞台元素）——————动画元素（相对舞台元素的深度）

perspective：

    perspective:??px;    //问号表示number数值

    视角-屏幕的距离；
    一般是正值；
    当该属性设置给舞台元素时，所有动画元素初始位置距离用户的距离则为该值。
    该属性也可以设置给具体一个动画元素，则该动画元素距离用户的距离为该值。

translateZ：

    transform: translateZ(3000px);    //使用时，所有基于transform属性下的属性，应该放在同一条transform属性上（即使一个是Z轴一个是X轴），否则后面使用的会覆盖前面的。

    屏幕（舞台元素）和动画元素相对运动的距离；
    值为正时，则在Z轴上往观察者（用户）靠近，值为负时，则远离。
    当该值和perspective的值相等时，说明该元素和用户视角所在位置重合（刚好看不到该元素）；
    
具体的话，请看DEMO图片（我自己画的）：

*当视角固定时，某个动画元素靠近用户时，只能看到部分区域的示意图.png*
    


###＊＊**舞台元素**＊＊

简单来说，就是所有动画元素的根元素。

所有动画元素都在这个元素上显示，通过设置舞台元素的大小，可以控制显示动画元素的范围。

而通过设置**overflow:hidden**这样的属性，让动画元素不能超出舞台元素显示。

####*属性*

    perspective:??px;    //透视属性，问号表示数字
    
本属性是指，你从距离多少px的位置来查看该元素。

具体而言，指视角（人的眼睛），距离屏幕的距离，所看到的3D模型投影在舞台元素上的2D画面。

简单来说，你透过窗户往外看，窗口大小是固定的，当你距离窗户越近，能看到的外面景色就越多，当你距离窗户越远，能看到外面的景色就越小。（依然是参考上面那个图片）

    overflow:hidden;    //超出部分不显示：即显示投影到视角范围的部分（demo图片的紫色区域）
    
设置这个属性，可以限制图片只在指定区域内显示。

    position:absolute;    //设置为非static（默认）属性值，方便子元素定位和调整位置（否则可能不好确定动画元素所在位置）。
    
用于方便容器定位其相对位置。

    perspective-origin:50% 50%;    //默认是居中
    
用于定位观察焦点在舞台元素上的位置，默认是居中。



###＊＊**容器**＊＊

将几个位置相关的动画元素放在同一个容器里，然后只需要设置他们相对于容器的位置即可。（例如创建一个长方体）

当需要调整动画元素的位置、旋转方向等时，只需要调整他们的容器的位置即可，便可以改变容器内所有元素的位置。

####*属性*

    transform-style: preserve-3d;
    
用于应用于父元素，设置其子元素是否继承3d，默认是flat（不继承），在使用3D时，应该使用preserve-3d这个值。

另外，【张鑫旭】的文章中说应该应用给舞台元素，但我在实践中发现，如果取消容器的该属性，单纯给舞台元素的话，则不能正常显示。

    transform: translateZ(0px);
    
用于调整容器的位置。除了Z之外，还可以修改X和Y。或者干脆使用translate3d(x, y, z)这样的形式。

以下指容器移动相对于舞台元素

X：+右-左；

Y：+下-上；（这个请参考html的XY轴坐标体系理解）

Z：+近-远；

    transform:rotateX(45deg);    //旋转，沿X轴旋转
    transform-origin: x y z;    //旋转的坐标轴
    
这2个属性用于对容器进行旋转。

简单来说，如果我们要旋转一个立方体，

首先，肯定要有一根轴线，即rotateX/Y/Z（沿X轴Y轴Z轴旋转）；

其次，我们需要确定这跟轴线在三维空间中的位置（注意，这里的三维空间，指的是相对于当前元素：如容器，的三维空间，而不是整个HTML的三维空间）；

因此，我们需要通过transform-origin给出的原点，来确定旋转时，坐标的基准点（即计算旋转时，x、y、z轴相交会的那个点）；有了点之后，再加上旋转轴就可以确定旋转情况了。

其中，transform-origin的x和y可以使用px也可以使用百分比（其左上角的点坐标为x:0, y:0），默认是50% 50%（居中）；

而默认z的值为0，可以使用px，但不能使用百分比。

至于rotateX(45deg)，表示沿X轴旋转45度，360deg是旋转一圈（和初始一样），正值是顺时针，负值是逆时针；

另外请注意，旋转的顺时针和逆时针跟轴的方向有关（x向右，y向下，z靠近用户）


###＊＊**动画元素**＊＊

多个动画元素放在同一个容器里，组成一个整体（比如说长方体）。

动画元素只需要考虑相对于容器的位置即可。

    transform: rotateX(-90deg);
    transform-origin: 0 0;
    
同容器元素
    
    backface-visibility: hidden;    //背面是否可见，默认是可见
    
当元素是半透明时，则默认可以看到元素的背面情况。但若属性设置为hidden，则背面元素将不可见。

    position设置之后，top、left、right、bottom相关
    
需要注意，旋转动画元素时，例如长100，宽100，深度是500时，我们需要设置上下左右四个方向的dom的基准位置。例如，放置于下方的元素，其除了设置transform-origin:0 100%;之外，应设置为bottom:0; left:0这样（只有这样才能构成一个长方体，不明白的话仔细想想，或者自己动手试试）